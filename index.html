<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text-Based-Game</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pixelify+Sans:wght@400..700&display=swap" rel="stylesheet">
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="script.js"></script>
    <script src="assets.js"></script>
</head>

<body>
    <div alt="Background" id="background-image" class="background-image" x-init="startup()"
        x-data="{ name: localStorage.getItem('name') || '', location: 'Warhamshire', screen: localStorage.getItem('name') ? 'encounter' : 'new-player', showPlayerBar: false, assets: getAssets() }"
        x-effect="showPlayerBar = !['new-player','how-to-play','journal','crafting'].includes(screen)">

        <div id="overlay-transparency" class="overlay-transparency"></div>

        <div class="player" id="player" x-show="showPlayerBar" x-init="updateBars()"
            x-data="{ crit: 0, accuracy: 0, evasion: 0, armor: 10, experience: 0, health: 500, maxHealth: 500, stamina: 30, maxStamina: 30, weaponry: 'Broken Dagger', armory: 'Damaged Cloak', level: 1 }">
            <p style="font-size: 60px; font-family: 'Pixelify Sans', sans-serif; margin-left: 20px;" x-text="name"></p>

            <div class="experience-bar-background"></div>
            <div class="health-bar-background"></div>
            <div class="stamina-bar-background"></div>

            <div class="experience-bar" id="experience"></div>
            <div class="health-bar" id="health"></div>
            <div class="stamina-bar" id="stamina"></div>

            <div class="experience-bar-stats" x-text="`${experience}/${Math.floor((level/0.07)**2)}`">0/0</div>
            <div class="health-bar-stats" x-text="`${health}/${maxHealth}`">0/0</div>
            <div class="stamina-bar-stats" x-text="`${stamina}/${maxStamina}`">0/0</div>

            <div class="mini-stats">
                <img src="assets/effects/Luck.png" alt="Crit Icon"
                    style="width: 20px; height: 20px; display: inline-block; transform: translateY(4px);">
                <span x-text="`${crit * 100}%`"></span>
                <img src="assets/effects/Focus.png" alt="Focus Icon"
                    style="width: 20px; height: 20px; display: inline-block; transform: translateY(4px);">
                <span x-text="`${accuracy * 100}%`"></span>
                <img src="assets/effects/Evasion.png" alt="Evasion Icon"
                    style="width: 20px; height: 20px; display: inline-block; transform: translateY(4px);">
                <span x-text="`${evasion * 100}%`"></span>
                <img src="assets/effects/Fortification.png" alt="Fortification Icon"
                    style="width: 20px; height: 20px; display: inline-block; transform: translateY(4px);">
                <span x-text="`${armor}`"></span>
            </div>
            <img src="assets/playerbar.png">
        </div>

        <div id="screen" class="screen">
            <!-- New Player (Title Screen)-->
            <div id="new-player" class="new-player" x-show="screen === 'new-player'" x-transition.opacity>
                <p style="text-align: center; font-size: 30px; top: 25px;">Welcome to</p>
                <h1 style="text-align: center; font-size: 60px; top: 50px; font-weight: bold;">Text - Based - Game</h1>
                <div class="centered-inputs">
                    <h1 style="text-align: center; font-size: 60px; font-family: 'Pixelify Sans', sans-serif;"
                        x-text="`${name ? `Why hello, ${name}!` : 'What is your name, Traveler?'}`">What is your
                        name, Traveler?</h1>
                    <input class="name-input" type="text" id="name" name="name" required minlength="1" maxlength="16"
                        size="100" placeholder="I'm..." x-model="name" autocomplete="off"
                        @keyup.enter="if (name) { startGame(name); }" />
                    <button class="regular-button" @click="startGame(name)" x-show="name" style="color: white;"
                        x-transition.opacity>Onwards</button>
                </div>
                <div class="credits">
                    <span style="color: grey;">Made by Jgouken &amp; SavorySam</span>
                    <span>Your gameplay is saved through cache and
                        cookies. If you clear or block either on this website, <u>you will lose your data.</u></span>
                    <span style="color: grey;">Art by MoBroPro</span>
                </div>
            </div>

            <!-- Returning Player (Landing Screen)-->
            <div id="returning" class="returning" x-show="screen === 'returning'" x-transition.opacity
                style="display: none;">
                <p style="text-align: center; font-size: 30px; top: 25px;">Text-Based-Game</p>
                <p style="text-align: center; font-size: 60px; font-family: 'Pixelify Sans', sans-serif; top: 400px;"
                    x-text="location.toUpperCase()"></p>

                <div class="centered-buttons" style="justify-content: right; margin-top: -100px; margin-right: 10px;">
                    <button class="regular-button"
                        style="background-color: rgb(20, 5, 228); color: white; border: 5px solid rgb(1, 0, 88); justify-content: right; font-size: large;"
                        @click="howToPlay()" x-transition.opacity>How To Play</button>
                </div>

                <div class="centered-buttons"
                    style="justify-content: left; margin-top: -54px; margin-left: 10px; gap: 20px; width: fit-content;">
                    <button class="regular-button"
                        style="background-color: red; color: white; border: 5px solid rgb(88, 0, 0); font-size: large;"
                        @click="deleteButton()" x-transition.opacity>DELETE</button>
                    <button class="regular-button"
                        style="background-color: rgb(42, 201, 42); border: 5px solid rgb(0, 88, 0); font-size: large;"
                        @click="exportButton()" x-transition.opacity>EXPORT</button>
                    <button class="regular-button"
                        style="background-color: rgb(20, 5, 228); color: white; border: 5px solid rgb(1, 0, 88); font-size: large;"
                        @click="importButton()" x-transition.opacity>IMPORT</button>
                </div>

                <div class="centered-buttons" style="margin-top: 440px;">
                    <button class="regular-button"
                        style="background-color: rgb(20, 5, 228); color: white; border: 5px solid rgb(1, 0, 88);"
                        @click="transition('returning', 'travel')" x-transition.opacity>Travel</button>
                    <button class=" regular-button"
                        style="background-color: rgb(42, 201, 42); border: 5px solid rgb(0, 88, 0);"
                        @click="transition('returning', 'encounter')" x-transition.opacity>Encounter</button>
                    <button class="regular-button"
                        style="background-color: red; color: white; border: 5px solid rgb(88, 0, 0);"
                        @click="quitButton()" x-transition.opacity>Quit</button>
                </div>

                <div class="centered-buttons" style="margin-top: 20px; gap: 20px;">
                    <button class="regular-button"
                        style="background-color: rgb(92, 80, 255); color: black; border: 5px solid rgb(6, 4, 122);"
                        @click="transition('returning', 'inventory')" x-transition.opacity>Inventory</button>
                    <button class="regular-button"
                        style="background-color: rgb(184, 111, 218); border: 5px solid rgb(153, 9, 219);"
                        @click="transition('returning', 'journal')" x-transition.opacity>Journal</button>
                    <button class="regular-button"
                        style="background-color: rgb(184, 255, 150); color: black; border: 5px solid rgb(15, 160, 1);"
                        @click="transition('returning', 'crafting')" x-transition.opacity>Crafting</button>
                </div>

                <div class="credits">
                    <span style="color: grey;">Made by Jgouken &amp; SavorySam</span>
                    <span>Your gameplay is saved through cache and
                        cookies. If you clear or block either on this website, <u>you will lose your data.</u></span>
                    <span style="color: grey;">Art by MoBroPro</span>
                </div>
            </div>

            <!-- How To Play -->
            <div id="how-to-play" class="how-to-play" x-show="screen === 'how-to-play'" x-transition.opacity>

            </div>

            <!-- Inventory -->
            <div id="inventory" class="inventory" x-show="screen === 'inventory'" x-transition.opacity>

            </div>

            <!-- Journal -->
            <div id="journal" class="journal" x-show="screen === 'journal'" x-transition.opacity>

            </div>

            <!-- Crafting-->
            <div id="crafting" class="crafting" x-show="screen === 'crafting'" x-transition.opacity>

            </div>

            <!-- Travel -->
            <div id="travel" class="travel" x-show="screen === 'travel'" x-transition.opacity>

            </div>

            <!-- Encounter -->
            <div id="encounter" class="encounters" x-show="screen === 'encounter'" x-data="{
                text: `${name} used Stab and hit Lazy Goblin for âš”ï¸38\nLazy Goblin used Stab and hit\n${name} used Stab and hit Lazy Goblin for âš”ï¸32\nðŸŽ‰ ${name} won the battle! ðŸŽ‰\n${name} gained ðŸ©µ294!\nâ¬†ï¸${name} leveled up to level 2! â¬†ï¸`
            }" x-transition.opacity>
                <div class="battle-log" x-text="text" style="white-space: pre-line;"></div>
            </div>

            <div class="battle-station"
                x-data="{ round: 1, synergized: assets.items.find(item => item.name == Alpine.$data(player).armory) ?.synergies.some(syn => syn.weapon == Alpine.$data(player).weaponry) ?? false }">
                <div class="battle-weaponry"
                    x-html="`âš”ï¸32\n\n${synergized ? `<u>` : ''}${Alpine.$data(player).weaponry}\n\n${Alpine.$data(player).armory}`"
                    style="white-space: pre-line; text-align: center;"></div>
                <div class="battle-buttons">
                    <div class="battle-actions" style="display: flex; gap: 20px;">
                        <button class="battle-base-attack"
                            style="background-color: rgb(253, 113, 113); color: black; border: 5px solid rgb(245, 17, 17); font-size: 40px; font-family: 'Pixelify Sans', sans-serif;"
                            x-text="assets.items.find(item => item.name == Alpine.$data(player).weaponry).skills[0].name"
                            @click="" x-transition.opacity>Attack</button>
                        <button class="battle-pass"
                            style="background-color: rgb(42, 143, 201); border: 5px solid rgb(6, 0, 88); font-size: 40px;font-family: 'Pixelify Sans', sans-serif;"
                            @click="" x-transition.opacity>Pass</button>
                        <button class="battle-item"
                            style="background-color: rgb(138, 233, 138); color: black; border: 5px solid rgb(0, 97, 21); font-size: 40px; font-size: 40px; font-family: 'Pixelify Sans', sans-serif;"
                            @click="" x-transition.opacity>Item</button>
                        <button class="battle-flee"
                            style="background-color: red; color: white; border: 5px solid rgb(88, 0, 0); font-size: 40px; font-size: 40px;font-family: 'Pixelify Sans', sans-serif;"
                            @click="" x-transition.opacity>Flee</button>
                    </div>

                    <div class="battle-skills"
                        style="display: flex; flex-direction: row; gap: 20px; justify-content: center; align-items: flex-start;">

                        <!-- Skill 1 Group -->
                        <div x-show="assets.items.find(item => item.name == Alpine.$data(player).weaponry).skills[1]">
                            <div style="display: flex; flex-direction: column; align-items: center; gap: 5px;">
                                <button class="battle-skill1" id="battle-skill1"
                                    x-text="assets.items.find(item => item.name == Alpine.$data(player).weaponry).skills[1].name"
                                    style="background-color: rgb(20, 5, 228); color: white; border: 5px solid rgb(1, 0, 88); font-size: 40px; font-family: 'Pixelify Sans', sans-serif;">
                                    ?
                                </button>
                                <span class="battle-skill1-cost" id="battle-skill1-cost"
                                    style="font-family: 'Pixelify Sans', sans-serif; font-size: 24px;"
                                    x-text="assets.items.find(item => item.name == Alpine.$data(player).weaponry).skills[1].cost">?</span>
                            </div>
                        </div>

                        <!-- Skill 2 Group -->
                        <div x-show="assets.items.find(item => item.name == Alpine.$data(player).weaponry).skills[2]">
                            <div style="display: flex; flex-direction: column; align-items: center; gap: 5px;">
                                <button class="battle-skill2" id="battle-skill2"
                                    style="background-color: rgb(20, 5, 228); color: white; border: 5px solid rgb(1, 0, 88); font-size: 40px; font-family: 'Pixelify Sans', sans-serif;"
                                    x-text="assets.items.find(item => item.name == Alpine.$data(player).weaponry).skills[2].name">
                                    ?
                                </button>
                                <span class="battle-skill2-cost" id="battle-skill2-cost"
                                    style="font-family: 'Pixelify Sans', sans-serif; font-size: 24px;"
                                    x-text="assets.items.find(item => item.name == Alpine.$data(player).weaponry).skills[2].cost">?</span>
                            </div>
                        </div>


                        <!-- Skill 3 Group -->
                        <div x-show="assets.items.find(item => item.name == Alpine.$data(player).weaponry).skills[3]">
                            <div style="display: flex; flex-direction: column; align-items: center; gap: 5px;">
                                <button class="battle-skill3" id="battle-skill3"
                                    style="background-color: rgb(20, 5, 228); color: white; border: 5px solid rgb(1, 0, 88); font-size: 40px; font-family: 'Pixelify Sans', sans-serif;"
                                    x-text="assets.items.find(item => item.name == Alpine.$data(player).weaponry).skills[3].name">
                                    ?
                                </button>
                                <span class="battle-skill3-cost" id="battle-skill3-cost"
                                    style="font-family: 'Pixelify Sans', sans-serif; font-size: 24px;"
                                    x-text="assets.items.find(item => item.name == Alpine.$data(player).weaponry).skills[3].cost">?</span>
                            </div>
                        </div>

                    </div>

                </div>
                <div class="round-info" x-text="'Round ' + round">Round 1</div>
            </div>
            <!-- Debug -->
            <div id="debug" class="encounters" x-show="screen === 'debug'" x-transition.opacity>

            </div>
        </div>
    </div>
</body>

</html>